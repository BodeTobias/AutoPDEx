<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Solution structures &mdash; AutoPDEx  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css?v=572af1d6" />
      <link rel="stylesheet" type="text/css" href="_static/thebelab.css" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css?v=acfd50eb" />
      <link rel="stylesheet" type="text/css" href="_static/dark_mode_css/general.css?v=c0a7eb24" />
      <link rel="stylesheet" type="text/css" href="_static/dark_mode_css/dark.css?v=70edf1c7" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=5929fcd5"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="_static/copybutton.js?v=f281be69"></script>
        <script src="_static/thebelab-helper.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script src="_static/dark_mode_js/default_light.js?v=c2e647ce"></script>
        <script src="_static/dark_mode_js/theme_switcher.js?v=358d3910"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="autopdex.solution_structures.solution_structure" href="_autosummary/autopdex.solution_structures.solution_structure.html" />
    <link rel="prev" title="autopdex.spaces.precompute_shape_functions" href="_autosummary/autopdex.spaces.precompute_shape_functions.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            AutoPDEx
              <img src="_static/logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.0.3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="notebooks/quickstart.html">Quickstart to AutoPDEx</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">High level operations</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="solver.html">Solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Models</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Settings</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="settings.html">Settings and static_settings</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="example_notebooks.html">Example notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examplary input files</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lower level operations</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="assembler.html">Assembler</a></li>
<li class="toctree-l1"><a class="reference internal" href="implicit_diff.html">Implicit_diff</a></li>
<li class="toctree-l1"><a class="reference internal" href="spaces.html">Spaces</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Solution structures</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#rvachev-function-solution-structures-and-precompilation-utilities">Rvachev function solution structures and precompilation utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/autopdex.solution_structures.solution_structure.html">autopdex.solution_structures.solution_structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/autopdex.solution_structures.precompile.html">autopdex.solution_structures.precompile</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/autopdex.solution_structures.precompute_function_and_derivatives.html">autopdex.solution_structures.precompute_function_and_derivatives</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/autopdex.solution_structures.precompute_coupled_boundary.html">autopdex.solution_structures.precompute_coupled_boundary</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/autopdex.solution_structures.precompute_projection.html">autopdex.solution_structures.precompute_projection</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="variational_schemes.html">Variational_schemes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Pre- and postprocessing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="geometry.html">Geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="seeder.html">Seeder</a></li>
<li class="toctree-l1"><a class="reference internal" href="utility.html">Utility</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotter.html">Plotter</a></li>
<li class="toctree-l1"><a class="reference internal" href="mesher.html">Mesher</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Source code</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/BodeTobias/AutoPDEx">GitHub Project</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">AutoPDEx</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Solution structures</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/BodeTobias/AutoPDEx/blob/main/docs/solution_structures.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="solution-structures">
<h1>Solution structures<a class="headerlink" href="#solution-structures" title="Link to this heading"></a></h1>
<p>In solving boundary or initial value problems, one generally seeks a function
that satisfies both certain boundary conditions and differential equations.
In solution structures, the boundary conditions (or at least part of them)
are already incorporated into the solution space. This provides greater flexibility
in the choice of variational methods and, depending on the approach, allows for
exact satisfaction of the boundary conditions.</p>
<p>This module provides functions to compute the solution structure at a given
integration point using different modes, as well as to precompile and evaluate discrete
solution structures by evaluating and storing shape functions, boundary conditions,
and projection operators. Precompilation can improve the efficiency,
but one has to consider how many discrete derivatives need to be evaluated for the given solution structure and pde.</p>
<p>The idea of the RFM (Rvachev-function method) solution structures is basically to multiply the solution space <span class="math notranslate nohighlight">\(\phi\)</span>
with a smooth function <span class="math notranslate nohighlight">\(\omega\)</span> that vanishes on the boundary and to add subsequently a function
<span class="math notranslate nohighlight">\(b\)</span> that satisfies the boundary conditions: <span class="math notranslate nohighlight">\(\tilde{\phi} = \omega \phi + b\)</span>.
The initial approximation <span class="math notranslate nohighlight">\(\phi\)</span> can e.g. be a finite element ansatz, but also some approach in which boundary conditions
can not simply nodally imposed, such as smooth meshfree shape functions or a neural network.
The global weighting function <span class="math notranslate nohighlight">\(\omega\)</span> can be constructed for example based on Rvachev functions
that can be used as smooth distance functions to certain primitive elements. The boundary function <span class="math notranslate nohighlight">\(b\)</span> can be set up
via transfinite interpolation in case there are different conditions on different segments of the boundary.
The above procedure works well e.g. for a Laplace equation with Dirichlet conditions, but special techniques have to be used for
more complex problems, see e.g. <a class="reference external" href="https://doi.org/10.1115/1.3005099">Rvachev and Sheiko (1995)</a>. These kind of solution structures
may be implemented as a user-specific solution structure ‘user’ (see the source code for examples).</p>
<p>Here, a general technique is implemented with the solution structure type ‘first order set’ which can handle
arbitrary order PDEs with multiple coupled boundary conditions.
However, the prerequisite is that the problem is reformulated into a set of first-order problems and that a suitable variational
method is used, such as a norm-equivalent first-order least square formulation
(see, e.g., <a class="reference external" href="https://link.springer.com/book/10.1007/b13382">Gunzburger and Bochev (2009)</a>).
This means that not only, for example, the temperature field <span class="math notranslate nohighlight">\(\theta\)</span> serves as a primary variable, but also its derivatives, such as
<span class="math notranslate nohighlight">\(\theta_{,X}\)</span> and <span class="math notranslate nohighlight">\(\theta_{,t}\)</span>. If we gather all the primary fields into the vector <span class="math notranslate nohighlight">\(\boldsymbol{\phi}\)</span>,
boundary conditions of the form <span class="math notranslate nohighlight">\(\boldsymbol{a}_i \cdot \boldsymbol{\phi} = b_i\)</span> can be imposed by the following approach:
<span class="math notranslate nohighlight">\(\tilde{\boldsymbol{\phi}} = \boldsymbol{P} \cdot \boldsymbol{\phi} + \tilde{\boldsymbol{b}}\)</span>
with the projector field <span class="math notranslate nohighlight">\(\boldsymbol{P} = \boldsymbol{I} - \sum_i (1 - \omega_i) \boldsymbol{a}_i \otimes \boldsymbol{a}_i\)</span>,
where <span class="math notranslate nohighlight">\(\boldsymbol{I}\)</span> is the identity matrix, <span class="math notranslate nohighlight">\(\omega_i\)</span> is a boundary segment selector as a smooth distance funcion and the
set of <span class="math notranslate nohighlight">\(\boldsymbol{a}_i\)</span> have to be orthogonal to each other at the boundary segments with each having a length of 1.
The boundary function can be set up based on transfinite interpolations based on
<span class="math notranslate nohighlight">\(\tilde{\boldsymbol{b}} = \sum_i b_i \boldsymbol{a}_i\)</span>. An example can be found e.g. in
<a class="reference external" href="https://github.com/BodeTobias/AutoPDEx/tree/main/examples/heat_conduction/space_time_fos_dirichlet_neumann_robin.py">space_time_fos_dirichlet_neumann_robin.py</a></p>
<section id="rvachev-function-solution-structures-and-precompilation-utilities">
<h2>Rvachev function solution structures and precompilation utilities<a class="headerlink" href="#rvachev-function-solution-structures-and-precompilation-utilities" title="Link to this heading"></a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_autosummary/autopdex.solution_structures.solution_structure.html#autopdex.solution_structures.solution_structure" title="autopdex.solution_structures.solution_structure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">solution_structure</span></code></a>(x, int_point_number, ...)</p></td>
<td><p>Computes the solution structure at a given integration point using various predefined schemes.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="_autosummary/autopdex.solution_structures.precompile.html#autopdex.solution_structures.precompile" title="autopdex.solution_structures.precompile"><code class="xref py py-obj docutils literal notranslate"><span class="pre">precompile</span></code></a>(dofs0, settings, static_settings)</p></td>
<td><p>Manually precompiles solution structures by evaluating and storing shape functions, boundary conditions, and projection operators for different integration points and domains.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="_autosummary/autopdex.solution_structures.precompute_function_and_derivatives.html#autopdex.solution_structures.precompute_function_and_derivatives" title="autopdex.solution_structures.precompute_function_and_derivatives"><code class="xref py py-obj docutils literal notranslate"><span class="pre">precompute_function_and_derivatives</span></code></a>(fun, x_int)</p></td>
<td><p>Precomputes a function and its derivatives up to a specified order at given integration points.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="_autosummary/autopdex.solution_structures.precompute_coupled_boundary.html#autopdex.solution_structures.precompute_coupled_boundary" title="autopdex.solution_structures.precompute_coupled_boundary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">precompute_coupled_boundary</span></code></a>(phi_0_fun, ...)</p></td>
<td><p>Precomputes coupled boundary conditions and their derivatives up to a specified order at given integration points.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="_autosummary/autopdex.solution_structures.precompute_projection.html#autopdex.solution_structures.precompute_projection" title="autopdex.solution_structures.precompute_projection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">precompute_projection</span></code></a>(psdf_fun, alpha_fun, x_int)</p></td>
<td><p>Precomputes the projection operator and its derivatives up to a specified order at given integration points.</p></td>
</tr>
</tbody>
</table>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="_autosummary/autopdex.spaces.precompute_shape_functions.html" class="btn btn-neutral float-left" title="autopdex.spaces.precompute_shape_functions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="_autosummary/autopdex.solution_structures.solution_structure.html" class="btn btn-neutral float-right" title="autopdex.solution_structures.solution_structure" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Tobias Bode.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>